/leonardo/prod/opt/libraries/cineca-ai/4.3.0/none/cineca-ai-env/lib/python3.11/site-packages/transformers/utils/generic.py:462: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
2025-12-23 01:15:42,800 - INFO - Starting inference
2025-12-23 01:15:42,801 - INFO - Args: {'config': 'config/default.yml', 'checkpoint': 'outputs/runs/exp_x3dm_heatmapfocal_BCE_3/best.ckpt', 'manifest_csv': 'manifests/test.csv', 'letterbox_meta': 'manifests/letterbox_meta.csv', 'export_roi': False, 'roi_dir': None, 'out_dir': 'outputs/runs/exp_x3dm_heatmapfocal_BCE_3', 'save_preds': 'outputs/runs/exp_x3dm_heatmapfocal_BCE_3/preds_test.csv', 'metrics_out': 'outputs/runs/exp_x3dm_heatmapfocal_BCE_3/metrics.json', 'sweep_curves': 'outputs/runs/exp_x3dm_heatmapfocal_BCE_3/curves', 'threshold': 0.5, 'batch_size': None, 'num_workers': 4, 'device': None, 'amp': False, 'soft_argmax': False, 'oracle_localization': False, 'center_thresholds_px': [8, 16, 24, 32], 'center_thresholds_km': [25, 50, 100, 200], 'heatmap_stride': None, 'image_size': None, 'roi_base_radius': 128, 'roi_sigma_multiplier': 2.0, 'temporal_T': None, 'temporal_stride': None, 'backbone': 'x3d_m', 'presence_from_peak': True, 'peak_threshold': None}
/leonardo/home/userexternal/ddarmien/cyc-firstpass/src/cyclone_locator/infer.py:174: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df["_sort_dt"] = pd.to_datetime(df["datetime"], errors="coerce")
2025-12-23 01:15:44,476 - INFO - Manifest loaded: 4708 records (4708 with presence GT, 2116 with center GT)
2025-12-23 01:15:44,477 - INFO - Temporal window: T=16, stride=4
2025-12-23 01:15:48,003 - INFO - Loaded checkpoint outputs/runs/exp_x3dm_heatmapfocal_BCE_3/best.ckpt with backbone=x3d_m
2025-12-23 01:17:20,628 - INFO - Inference done on 4708 samples in 92.6s (50.8 img/s, 19.67s / 1k)
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/leonardo/home/userexternal/ddarmien/cyc-firstpass/src/cyclone_locator/infer.py", line 775, in <module>
    main()
  File "/leonardo/home/userexternal/ddarmien/cyc-firstpass/src/cyclone_locator/infer.py", line 627, in main
    meta_map = load_letterbox_meta(args.letterbox_meta)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo/home/userexternal/ddarmien/cyc-firstpass/src/cyclone_locator/infer.py", line 216, in load_letterbox_meta
    "orig_w": int(row["orig_w"]),
              ^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
