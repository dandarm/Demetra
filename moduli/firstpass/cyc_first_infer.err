/leonardo/prod/opt/libraries/cineca-ai/4.3.0/none/cineca-ai-env/lib/python3.11/site-packages/transformers/utils/generic.py:462: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
2025-12-27 23:48:41,165 - INFO - Starting inference
2025-12-27 23:48:41,166 - INFO - Args: {'config': 'config/default.yml', 'checkpoint': 'outputs/runs/exp_x3dm_dsnt_6_notempstride/best.ckpt', 'manifest_csv': 'manifests/test.csv', 'letterbox_meta': 'manifests/letterbox_meta.csv', 'export_roi': False, 'roi_dir': None, 'out_dir': 'outputs/runs/exp_x3dm_dsnt_6_notempstride/preds', 'save_preds': 'outputs/runs/exp_x3dm_dsnt_6_notempstride/preds_test.csv', 'metrics_out': 'outputs/runs/exp_x3dm_dsnt_6_notempstride/preds/metrics.json', 'sweep_curves': 'outputs/runs/exp_x3dm_dsnt_6_notempstride/preds/curves', 'threshold': 0.5, 'batch_size': None, 'num_workers': 4, 'device': None, 'amp': False, 'soft_argmax': True, 'soft_argmax_tau': None, 'oracle_localization': False, 'center_thresholds_px': [8, 16, 24, 32], 'center_thresholds_km': [25, 50, 100, 200], 'heatmap_stride': None, 'image_size': None, 'roi_base_radius': 128, 'roi_sigma_multiplier': 2.0, 'temporal_T': None, 'temporal_stride': None, 'backbone': None, 'presence_from_peak': True, 'peak_threshold': None, 'peak_pool': None, 'peak_tau': None}
/leonardo/home/userexternal/ddarmien/cyc-firstpass/src/cyclone_locator/infer.py:180: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df["_sort_dt"] = pd.to_datetime(df["datetime"], errors="coerce")
2025-12-27 23:48:44,029 - INFO - Manifest loaded: 4708 records (4708 with presence GT, 2116 with center GT)
2025-12-27 23:48:44,029 - INFO - Temporal window: T=16, stride=1
2025-12-27 23:48:47,598 - INFO - Loaded checkpoint outputs/runs/exp_x3dm_dsnt_6_notempstride/best.ckpt with backbone=x3d_m
2025-12-27 23:50:17,305 - INFO - Inference done on 4708 samples in 89.7s (52.5 img/s, 19.05s / 1k)
2025-12-27 23:50:19,422 - WARNING - Dropped 6 rows with NaN in letterbox meta manifests/letterbox_meta.csv
2025-12-27 23:50:27,288 - INFO - Loaded letterbox meta for 144841 frames
2025-12-27 23:50:27,311 - INFO - ROI export disattivato: meta caricati ma non verranno salvati ritagli.
2025-12-27 23:50:27,364 - INFO - Predictions saved to outputs/runs/exp_x3dm_dsnt_6_notempstride/preds_test.csv
2025-12-27 23:50:27,530 - INFO - Geo metrics computed on 57 samples
2025-12-27 23:50:27,532 - INFO - Metrics saved to outputs/runs/exp_x3dm_dsnt_6_notempstride/preds/metrics.json
2025-12-27 23:50:27,541 - INFO - Saved sweep curves to outputs/runs/exp_x3dm_dsnt_6_notempstride/preds/curves
